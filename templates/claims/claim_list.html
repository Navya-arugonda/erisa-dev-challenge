{% extends "base.html" %}
{% block title %}Claims{% endblock %}

{% block content %}
<div class="container">

  {# The form itself sends the GET + includes ALL its fields #}
  <form id="filters"
      action="."
      method="get"
      hx-get="."
      hx-target="#claim-table"
      hx-swap="outerHTML"
      hx-push-url="true"
      hx-trigger="change, keyup changed delay:300ms from:#q">

  <input id="q"
         class="input"
         type="search"
         name="q"
         value="{{ q|default:'' }}"
         placeholder="Search by ID / patient / payer" />

  <select class="select" name="status">
    <option value="">All statuses</option>
    {% for s in statuses %}
      <option value="{{ s }}" {% if status_sel == s %}selected{% endif %}>{{ s }}</option>
    {% endfor %}
  </select>

  <a class="btn" href="{% url 'dashboard' %}">Dashboard</a>
  <button class="btn" type="submit">Apply</button>  {# fallback for non-JS #}
</form>

<div id="claim-detail-target" class="card" style="margin-bottom:1rem;"></div>

<div id="claim-table" class="card" hx-swap="outerHTML">
  {% include "includes/claim_table.html" %}
</div>

</div>
{% endblock %}

{% extends "base.html" %}
{% block title %}Claims{% endblock %}

{% block content %}
<div class="container">

  {# Filter/search form. HTMX submits itself on change/typing. #}
  <form id="filters"
        action="."
        method="get"
        hx-get="."
        hx-target="#claim-table"
        hx-swap="outerHTML"
        hx-push-url="true"
        hx-trigger="change, keyup changed delay:300ms from:#q">

    <input id="q"
           class="input"
           type="search"
           name="q"
           value="{{ q|default:'' }}"
           placeholder="Search by ID / patient / payer" />

    <select class="select" name="status">
      <option value="">All statuses</option>
      {% for s in statuses %}
        <option value="{{ s }}" {% if status_sel == s %}selected{% endif %}>{{ s }}</option>
      {% endfor %}
    </select>

    <a class="btn" href="{% url 'dashboard' %}">Dashboard</a>

    {# â–¶ Add Claim opens the HTMX form in the panel below #}
    <button class="btn"
            type="button"
            hx-get="{% url 'claim-create' %}"
            hx-target="#claim-detail-target"
            hx-swap="innerHTML">
      Add Claim
    </button>
  </form>

  {# where the HTMX detail/form panel renders #}
  <div id="claim-detail-target" class="card" style="margin:1rem 0 1.25rem;"></div>

  {# the table panel that HTMX keeps replacing #}
  <div id="claim-table" class="card" hx-swap="outerHTML">
    {% include "includes/claim_table.html" %}
  </div>
</div>
{% endblock %}
